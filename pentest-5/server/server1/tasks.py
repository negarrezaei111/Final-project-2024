import logging

from celery import shared_task


from .models import Scan

logger = logging.getLogger(__name__)


@shared_task
def stop_scan_task(scan_identifier):
    scans = Scan.objects.filter(scan_identifier=scan_identifier, status='in_progress')

    if not scans.exists():
        return False

    for scan in scans:
        scan.status = 'failed'
        scan.save()
        print("stopped in tasks")
        scan.is_stopping = True

    return True
